Messy code, just for training. Poor optimization.
